<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61317191-1', 'auto');
  ga('send', 'pageview');

</script>
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Adding more actions to JellyBean Notifications</title>
	
	<meta name="author" content="Udi Cohen">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">



	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/udinic">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/udinic">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a class="navbar-brand" href="/">
				<img src="http://www.gravatar.com/avatar/107169775092a3ef4ae94fad5695613a?s=35" class="img-circle" />
				
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
 		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/archives">Archives</a></li>
				<li><a href="/about">About</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
<!-- 	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>
 -->
	<div class="col-sm-3 sidebar hidden-xs">
		<! -- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<i class="fa fa-cube" ></i>
	</a>

</header>

<div class="text-center sidebar-title">
	UDI COHEN
</div>	


<div class="text-center sidebar-bio">
	My adventures
</div>


	<!-- <i class="fa fa-square"></i> -->

<div class="text-center sidebar-links">
	<a href="/">Home</a>
	| 
	<a href="/archives">Archives</a>	
	|
	<a href="/about">About</a>
</div>

<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm twitter" href="https://twitter.com/udinic">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm github" href="https://github.com/udinic">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		
		<li>
			<a class="btn btn-default btn-sm linkedin" href="https://linkedin.com/in/udinic">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm rss" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<! -- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3 main-content">
		<div class="page-header">
  <h1>Adding more actions to JellyBean Notifications </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   July 
	   23rd,
	     
	   2012
	 </span>
	  <div class="article_body">
	  <p>One of most useful features on Android are the Notifications. While iOS just got them – Android keeps improving them. JellyBean has presented some sweet notifications’ features. Larger area, multiline text entry, list of different items and pictures. There’s also an option to create your own custom layout to present there (though I think it potentially can ruin the uniformity of the notifications design). All those “tall” notifications can be also collapsed/expended to save some space. One more thing, and this could be the coolest of all, is the option to add **actions **to the notifications.</p>

<p><img src="/assets/images/2012-07-23-adding-more-actions-to-jellybean-notifications/image_thumb5.png" alt="image" />   <img src="/assets/images/2012-07-23-adding-more-actions-to-jellybean-notifications/image5_thumb.png" alt="image" /></p>

<p>(Sample notifications on JellyBean. Taken using <a href="https://github.com/JakeWharton/NotificationCompat2">NotificationCompat2</a> sample app, by Jake Wharton)</p>

<p>Three actions don’t (always) make it right.</p>

<p>Each notification can suggest <strong>up to 3 actions</strong>, but what if I want <strong>more</strong>? Maybe I want that a click on one action will give some other actions to pick from? I know it’s not a common case, but I can think of several cases where it can be useful. Since all the notifications are built on the same way AppWidgets are built, using RemoteViews, there are not much place for run-time manipulation.</p>

<p>Seems like the <strong>old switch-a-roo</strong> will do the trick here.</p>

<p>Changing the actions is possible by replacing the whole notification with a new one. The replacing notification can have a different title and different actions from the previous one, but it must have the same notification id. This is how it’ll look like:</p>

<p><a href="/assets/images/2012-07-23-adding-more-actions-to-jellybean-notifications/image6.png"><img src="/assets/images/2012-07-23-adding-more-actions-to-jellybean-notifications/image_thumb6.png" alt="image" /></a></p>

<p>How to do that?</p>

<p>First, let’s clarify something – notification’s actions don’t just have an OnClickListener like regular buttons, they fire an Intent using a PendingIntent. A receiver needs to receive that Intent and “notify” the replacing notification to the Android’s Notification Service. The receiver can be a BroadcastReceiver, Service or even an Activity, but we want something that doesn’t take much resources/loading-time (as an Activity) or doesn’t have the potential to be called from other applications (as a BroadcastReveiver). A Service, or even simpler – IntentService, will fit perfectly here.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NotificationReplaceService</span> <span class="kd">extends</span> <span class="nc">IntentService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">ACTION_SWITCH_NOTIFICATIONS</span> <span class="o">=</span> <span class="s">"com.jakewharton.notificationcompat2.SWITCH_NOTIFICATIONS"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">SWITCH_NOTIFICATION_ARG_ID</span> <span class="o">=</span> <span class="s">"NOTIF_ID"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">SWITCH_NOTIFICATION_ARG_NOTIFICATION</span> <span class="o">=</span> <span class="s">"NOTIF_NOTIFICATION"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">NotificationReplaceService</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"NotificationReplaceService"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHandleIntent</span><span class="o">(</span><span class="nc">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="no">ACTION_SWITCH_NOTIFICATIONS</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getAction</span><span class="o">()))</span> <span class="o">{</span>

            <span class="kt">int</span> <span class="n">notifiId</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getIntExtra</span><span class="o">(</span><span class="no">SWITCH_NOTIFICATION_ARG_ID</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">);</span>
            <span class="nc">Notification</span> <span class="n">notification</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getParcelableExtra</span><span class="o">(</span><span class="no">SWITCH_NOTIFICATION_ARG_NOTIFICATION</span><span class="o">);</span>

            <span class="c1">// Creating the new notification based on the data came from the intent</span>
            <span class="nc">NotificationManager</span> <span class="n">mgr</span> <span class="o">=</span> <span class="o">(</span><span class="nc">NotificationManager</span><span class="o">)</span> <span class="n">getSystemService</span><span class="o">(</span><span class="no">NOTIFICATION_SERVICE</span><span class="o">);</span>
            <span class="n">mgr</span><span class="o">.</span><span class="na">notify</span><span class="o">(</span><span class="n">notifiId</span><span class="o">,</span> <span class="n">notification</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>This service supports the “SWITCH_NOTIFICATION” action, which has 2 extras:</p>

<ul>
  <li>
    <p>Notification Id: Must be the same as the notification we’re replacing</p>
  </li>
  <li>
    <p>Notification object: The second notification we replace the current notification with</p>
  </li>
</ul>

<p>Luckily for us – the Notification class is <a href="http://developer.android.com/reference/android/os/Parcelable.html">Parcelable</a>, meaning I can pass it as one of the Intent’s extras with no problem.</p>

<p>To illustrate this idea, I used Jake Wharton’s <a href="https://github.com/JakeWharton/NotificationCompat2">NotificationCompat2</a> project, which gives a simple API to build notifications for all Android versions from 1.6 to 4.1. My service was added to the manifest</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml">        <span class="c">&lt;!-- Declaring the service --&gt;</span>
        <span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">"com.jakewharton.notificationcompat2.NotificationReplaceService"</span><span class="nt">/&gt;</span></code></pre></figure>

<p>I created the first notification, the one to be replaced:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">Notification</span> <span class="n">notiMain</span> <span class="o">=</span> <span class="n">getSimple</span><span class="o">(</span><span class="s">"Action with extension"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">android</span><span class="o">.</span><span class="na">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">sym_def_app_icon</span><span class="o">,</span> <span class="s">"Action"</span><span class="o">,</span> <span class="n">getPendingIntent</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="n">android</span><span class="o">.</span><span class="na">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">sym_def_app_icon</span><span class="o">,</span> <span class="s">"More.."</span><span class="o">,</span> <span class="n">intentReplaceNotification</span><span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre></figure>

<p>The <em>intentReplaceNotification _is the PendingIntent fired when pressing the “More..” action on the notification. This pending intent is the one in charge of calling the _NotificationReplaceService</em> with the replacing notification.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// First - Building the extended notification.</span>
<span class="c1">// This will replace the first one when the "More.." button will be pressed</span>
<span class="nc">Notification</span> <span class="n">notiReplacement</span> <span class="o">=</span> <span class="n">getSimple</span><span class="o">(</span><span class="s">"Actions extended"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">no_icon</span><span class="o">,</span> <span class="s">"udinic1"</span><span class="o">,</span> <span class="n">getPendingIntent</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">no_icon</span><span class="o">,</span> <span class="s">"udinic2"</span><span class="o">,</span> <span class="n">getPendingIntent</span><span class="o">())</span>
        <span class="o">.</span><span class="na">addAction</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">drawable</span><span class="o">.</span><span class="na">no_icon</span><span class="o">,</span> <span class="s">"udinic3"</span><span class="o">,</span> <span class="n">getPendingIntent</span><span class="o">())</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="c1">// Creating the switch notification intent.</span>
<span class="c1">// The receiver will get this and send notiExtended to the NotificationManager, replacing the current one with the same Id</span>
<span class="nc">Intent</span> <span class="n">switchNotificationIntent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Intent</span><span class="o">();</span>
<span class="n">switchNotificationIntent</span><span class="o">.</span><span class="na">setClass</span><span class="o">(</span><span class="nc">SampleActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="nc">NotificationReplaceService</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">switchNotificationIntent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="no">ACTION_SWITCH_NOTIFICATIONS</span><span class="o">);</span>
<span class="n">switchNotificationIntent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="no">SWITCH_NOTIFICATION_ARG_ID</span><span class="o">,</span> <span class="n">notifiId</span><span class="o">);</span>
<span class="n">switchNotificationIntent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="no">SWITCH_NOTIFICATION_ARG_NOTIFICATION</span><span class="o">,</span> <span class="n">notiReplacement</span><span class="o">);</span>
<span class="nc">PendingIntent</span> <span class="n">intentReplaceNotification</span> <span class="o">=</span> <span class="nc">PendingIntent</span><span class="o">.</span><span class="na">getService</span><span class="o">(</span><span class="nc">SampleActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">switchNotificationIntent</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span></code></pre></figure>

<p>Here we created the replacing notification, and passing it to the replacing action intent. This intent will start my _NotificationReplaceService, _which will use the intent’s extras to replace the main notification.</p>

<p>All that is left now to do is to notify the main notification to the Android’s Notification Service</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">NotificationManager</span> <span class="n">mgr</span> <span class="o">=</span> <span class="o">(</span><span class="nc">NotificationManager</span><span class="o">)</span> <span class="n">getSystemService</span><span class="o">(</span><span class="no">NOTIFICATION_SERVICE</span><span class="o">);</span>
<span class="n">mgr</span><span class="o">.</span><span class="na">notify</span><span class="o">(</span><span class="n">notifiId</span><span class="o">,</span> <span class="n">notiMain</span><span class="o">);</span></code></pre></figure>

<p>And that’s it!</p>

<p>You can check the full code on my <a href="https://github.com/Udinic/NotificationCompat2">GitHub account</a>. Just please do me one favor – don’t abuse this method to create a complex menu in the users’ notification bar, think about your users!</p>

	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#Android-ref">
					Android</span>
					
				</a></li>
			
		  
		</ul>
		  
		
		<ul class="tag_box list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#actions-ref">
					actions
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#Android-ref">
					Android
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#jelly-bean-ref">
					jelly-bean
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#Jellybean-ref">
					Jellybean
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#Notification bar-ref">
					Notification bar
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#NotificationCompat2-ref">
					NotificationCompat2
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#notifications-ref">
					notifications
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#RemoteViews-ref">
					RemoteViews
					
					</a>
				</li>
			
		  
		  
		</ul>
		  


	<div align="center" class="author-container">
		<figure class="author-img-post">
			<img src="http://www.gravatar.com/avatar/107169775092a3ef4ae94fad5695613a" class="img-circle author-image" />			
		</figure>
        <h4 class="section-title">Written by Udi Cohen</h4>
	</div>
	<div class="share-container">					
      <section class="share" align="center">
        <p class="section-title">Share this post:</p>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Adding more actions to JellyBean Notifications&via=udinic"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" 
           onclick="window.open('https://www.facebook.com/sharer/sharer.php?u='+window.location.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm reddit"
           onclick="window.open('http://www.reddit.com/submit?url='+window.location.href+'&title=Adding more actions to JellyBean Notifications', 'reddit-share', 'width=580,height=530');return false;">
          <i class="fa fa-reddit fa-lg"></i>
          Reddit
        </a>
      </section>

    </div>

    <!-- <div class="clearfix"></div> -->

	<!-- <hr> -->
	
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'udinic-blog';
    var disqus_identifier = '/2012/07/23/adding-more-actions-to-jellybean-notifications/';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

	</div>
	








</article>
<div class="clearfix"></div>



		<footer>
			<p>
				&copy; 2025 Udi Cohen with Jekyll. Theme: Customized (based of <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek).
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>

